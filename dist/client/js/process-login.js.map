{"version":3,"sources":["../../../client/js/process-login.js"],"names":["displayErrorInFields","errors","field","document","getElementById","innerHTML","processLogIn","url","email","forms","signIn","value","password","fields","dataForFetch","method","body","JSON","stringify","headers","fetch","then","res","json","data","forEach","message","window","localStorage","setItem","token","location","href","error","console","log"],"mappings":";;;;AAAA,IAAMA,uBAAuB,SAAvBA,oBAAuB,CAACC,MAAD,EAASC,KAAT,EAAmB;AAC9CC,WAASC,cAAT,QAA2BF,KAA3B,aAAyCG,SAAzC,sCAC0BJ,OAAOC,KAAP,CAD1B;AAED,CAHD;;AAKA,IAAMI,eAAe,SAAfA,YAAe,GAAM;AACzB,MAAMC,MAAM,qEAAZ;AACA,MAAMC,QAAQL,SAASM,KAAT,CAAeC,MAAf,CAAsBF,KAAtB,CAA4BG,KAA1C;AACA,MAAMC,WAAWT,SAASM,KAAT,CAAeC,MAAf,CAAsBE,QAAtB,CAA+BD,KAAhD;;AAEAR,WAASC,cAAT,CAAwB,YAAxB,EAAsCC,SAAtC,GAAkD,EAAlD;AACAF,WAASC,cAAT,CAAwB,eAAxB,EAAyCC,SAAzC,GAAqD,EAArD;AACAF,WAASC,cAAT,CAAwB,cAAxB,EAAwCC,SAAxC,GAAoD,EAApD;;AAEA,MAAMQ,SAAS,CAAC,OAAD,EAAU,UAAV,CAAf;AACA,MAAMC,eAAe;AACnBC,YAAQ,MADW;AAEnBC,UAAMC,KAAKC,SAAL,CAAe,EAAEV,YAAF,EAASI,kBAAT,EAAf,CAFa;AAGnBO,aAAS,EAAE,gBAAgB,kBAAlB;AAHU,GAArB;;AAMAC,QAAMb,GAAN,EAAWO,YAAX,EACGO,IADH,CACQ;AAAA,WAAOC,IAAIC,IAAJ,EAAP;AAAA,GADR,EAEGF,IAFH,CAEQ,UAACG,IAAD,EAAU;AACd,QAAIA,KAAKvB,MAAT,EAAiB;AACf,UAAIuB,KAAKvB,MAAL,KAAgB,IAAhB,IAAwB,QAAOuB,KAAKvB,MAAZ,MAAuB,QAAnD,EAA6D;AAC3DY,eAAOY,OAAP,CAAe,UAACvB,KAAD,EAAW;AACxB,cAAIsB,KAAKvB,MAAL,CAAYC,KAAZ,CAAJ,EAAwB;AACtB,mBAAOF,qBAAqBwB,KAAKvB,MAA1B,EAAkCC,KAAlC,CAAP;AACD;AACF,SAJD;AAKD,OAND,MAMO;AACLC,iBAASC,cAAT,CAAwB,cAAxB,EAAwCC,SAAxC,sCAC0BmB,KAAKvB,MAD/B;AAED;AACF,KAXD,MAWO,IAAIuB,KAAKE,OAAT,EAAkB;AACvBC,aAAOC,YAAP,CAAoBC,OAApB,CAA4B,aAA5B,EAA2C,SAA3C;AACAF,aAAOC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,EAAoC,GAApC;AACAF,aAAOC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,EAAqCL,KAAKM,KAA1C;AACAH,aAAOC,YAAP,CAAoBC,OAApB,CAA4B,SAA5B,EAAuCL,KAAKE,OAA5C;AACAC,aAAOI,QAAP,CAAgBC,IAAhB,GAAuB,kBAAvB;AACD;AACF,GArBH,WAsBS,UAACC,KAAD,EAAW;AAChBC,YAAQC,GAAR,CAAYF,KAAZ;AACD,GAxBH;;AA0BA,SAAO,KAAP;AACD,CA3CD","file":"process-login.js","sourcesContent":["const displayErrorInFields = (errors, field) => {\n  document.getElementById(`${field}Error`).innerHTML =\n  `<h1 class=\"errorField\">${errors[field]}</h1>`;\n};\n\nconst processLogIn = () => {\n  const url = 'https://deploy-challenge3-to-heroku.herokuapp.com/api/v1/auth/login';\n  const email = document.forms.signIn.email.value;\n  const password = document.forms.signIn.password.value;\n\n  document.getElementById('emailError').innerHTML = '';\n  document.getElementById('passwordError').innerHTML = '';\n  document.getElementById('errorMessage').innerHTML = '';\n\n  const fields = ['email', 'password'];\n  const dataForFetch = {\n    method: 'POST',\n    body: JSON.stringify({ email, password }),\n    headers: { 'Content-Type': 'application/json' }\n  };\n\n  fetch(url, dataForFetch)\n    .then(res => res.json())\n    .then((data) => {\n      if (data.errors) {\n        if (data.errors !== null && typeof data.errors === 'object') {\n          fields.forEach((field) => {\n            if (data.errors[field]) {\n              return displayErrorInFields(data.errors, field);\n            }\n          });\n        } else {\n          document.getElementById('errorMessage').innerHTML =\n          `<h1 class=\"errorField\">${data.errors}</h1>`;\n        }\n      } else if (data.message) {\n        window.localStorage.setItem('entriesPage', 'default');\n        window.localStorage.setItem('page', '1');\n        window.localStorage.setItem('token', data.token);\n        window.localStorage.setItem('welcome', data.message);\n        window.location.href = 'all-entries.html';\n      }\n    })\n    .catch((error) => {\n      console.log(error);\n    });\n\n  return false;\n};\n"]}